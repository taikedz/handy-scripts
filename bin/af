#! /bin/bash

[[ $# = 0 ]] && {
	cat <<EOF
Usage

	$0 list                 # list installed packages
	$0 update               # updates the package list
	$0 upgrade              # perform a straight package upgrade
	$0 TERM                 # search for TERM
	$0 {s|show} PACKAGE     # show information about PACKAGE
	$0 {i|install} PACKAGES ...  # install packages

Specify a package to search, show, or install.

Installation and upgrade tasks run with the --assume-yes flag, and
perform auto-remove and autoclean.

The tool uses sudo to run actions that require root.

EOF
	exit
}

iopt='^(i|install)$'
if [[ $# -gt 1 ]] && [[ $1 =~ $iopt ]]; then
	shift
	sudo apt install $@ -y
	sudo apt-get autoremove -y
	sudo apt-get autoclean -y
	exit
fi

sopt='^(s|show)$'
if [[ $# -gt 1 ]] && [[ $1 =~ $sopt ]]; then
	shift
	apt-cache show $@ | sed -r 's/^(Package: )/\n\n\1/' | less
	exit
fi

if [[ $# = 1 ]] && [[ $1 = "update" ]]; then
	sudo apt update
	exit
fi

if [[ $# = 1 ]] && [[ $1 = "upgrade" ]]; then
	sudo apt upgrade -y
	sudo apt-get autoremove -y
	sudo apt-get autoclean -y
	exit
fi

if [[ $# = 1 ]] && [[ $1 = 'list' ]]; then
	dpkg --get-selections | less
	exit
fi


# else search
apt-cache search $@ | less
